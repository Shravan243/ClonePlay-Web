<html>
  <head>
    <title>ClonePlay</title>

    <!-- <style>
      body {
        min-height: 100vh;
        display: flex;
        /* justify-content: center; */
        align-items: center;
        background-color: antiquewhite;
        flex-direction: column;
      }
      #cloneForm {
        /* margin-top: 12%; */
        border: solid 5px burlywood;
        background-color: blanchedalmond;
        border-radius: 8px;
        padding: 10px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        /* margin-left: auto;
        margin-right: auto; */
        justify-self: center;
      }
      h1 {
        margin-top: 7%;
      }
      label {
        justify-content: center;
        align-items: center;
      }
      .submitBtn {
        border: solid 2px rgb(206, 205, 205);
        background-color: aliceblue;
        transition: transform 0.2s ease;
        border-radius: 7px;
      }
      .submitBtn:hover {
        background-color: rgb(206, 205, 205);
        transform: scale(1.03);
      }
      #loginBtn {
        margin-bottom: 25px;
      }
      .steps {
        text-wrap: word-wrap;
        display: flex;
        justify-content: center;
        align-items: center;
        /* border: solid 3px rgb(69, 34, 34); */
        /* padding: 2 10 2 10; */
        width: 500px;
        font-size: x-large;
        background-color: burlywood;
        color: white;
        border-radius: 7px;
        margin-bottom: 50px;
      }
      #result {
        margin-top: 20px;
        padding: 15px;
        border: 2px solid green;
        background-color: #eaffea;
        border-radius: 8px;
        display: none;
        font-weight: bold;
        color: #1a4d1a;
      }

      header,
      footer {
        width: 100%;
        height: 80px;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: rgb(69, 34, 34);
      }
      .middle-box {
        display: flex;
        flex-direction: row;
        flex: 1;
      }
      .icon {
        height: 50px;
        width: 50px;
      }
      .Support {
        margin: 50px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
    </style> -->

    <style>
      /* ------------- RESET + THEME ------------- */
      *,
      *::before,
      *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        font-family: "Segoe UI", Roboto, "Helvetica Neue", sans-serif;
      }
      :root {
        --bg: #fffaf5;
        --surface: #fff;
        --surface-alt: #f9e7d2;
        --accent: #ff7e6b;
        --accent-dark: #e25d49;
        --text: #2d2d2d;
        --text-soft: #5f5f5f;
        --radius: 12px;
        --shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
      }
      html,
      body {
        height: 100%;
      }
      body {
        background: var(--bg);
        color: var(--text);
        display: flex;
        flex-direction: column;
      }

      /* ------------- HEADER / FOOTER ------------- */
      header,
      footer {
        background: var(--accent);
        color: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 72px;
        padding: 0 1rem;
        font-weight: 700;
        letter-spacing: 0.5px;
        text-transform: uppercase;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      footer {
        margin-top: auto;
      }

      /* ------------- MAIN WRAPPER ------------- */
      .middle-box {
        flex: 1;
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        align-items: center;
        justify-content: center;
        gap: 3rem;
        max-width: 1100px;
        width: 100%;
        margin: 0 auto;
        padding: 2rem 1rem;
        flex: 1;
      }

      /* ------------- SUPPORTED-APPS PANEL ------------- */
      .Support {
        background: var(--surface);
        padding: 1.5rem;
        border: 4px dashed var(--accent);
        border-radius: var(--radius);
        text-align: center;
        box-shadow: var(--shadow);
      }
      .Support h4 {
        margin-bottom: 1rem;
        color: var(--accent-dark);
      }
      .icon {
        width: 56px;
        height: 56px;
        margin: 0.35rem;
        object-fit: contain;
        transition: transform 0.2s ease;
      }
      .icon:hover {
        transform: scale(1.1);
      }

      /* ------------- CLONE FORM ------------- */
      #cloneForm {
        background: var(--surface);
        padding: 2rem 2.5rem;
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        display: flex;
        flex-direction: column;
        gap: 1.25rem;
        width: 320px;
        margin-left: auto;
        margin-right: auto;
      }
      #cloneForm label {
        font-weight: 600;
        color: var(--text-soft);
      }
      #cloneForm input {
        padding: 0.55rem 0.75rem;
        border: 2px solid var(--accent);
        border-radius: var(--radius);
        outline: none;
        transition: border-color 0.2s ease;
      }
      #cloneForm input:focus {
        border-color: var(--accent-dark);
      }

      /* ------------- BUTTONS ------------- */
      .submitBtn,
      #loginBtn {
        cursor: pointer;
        border: none;
        background: var(--accent);
        color: #fff;
        padding: 0.65rem 1.2rem;
        border-radius: var(--radius);
        font-weight: 600;
        letter-spacing: 0.3px;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
        transition: transform 0.18s ease, background 0.18s ease;
      }
      .submitBtn:hover,
      #loginBtn:hover {
        background: var(--accent-dark);
        transform: translateY(-2px);
      }
      #loginBtn {
        margin: 2rem auto 0;
        display: block;
      }

      /* ------------- INFO BANNER ------------- */
      .steps {
        margin: 1.5rem auto 0;
        max-width: 460px;
        background: var(--surface-alt);
        color: #fff;
        text-align: center;
        padding: 1rem 1.2rem;
        border-radius: var(--radius);
        font-weight: 500;
        box-shadow: var(--shadow);
      }

      /* ------------- RESULT MESSAGE ------------- */
      #result {
        max-width: 460px;
        margin: 1.5rem auto 0;
        padding: 1rem;
        border-left: 6px solid green;
        background: #eaffea;
        border-radius: var(--radius);
        font-weight: 600;
        display: none;
      }

      /* ------------- RESPONSIVE TWEAKS ------------- */
      @media (max-width: 768px) {
        .middle-box {
          flex-direction: column;
          gap: 2rem;
          padding-top: 1rem;
        }
        .Support {
          order: 2;
        }
        #cloneForm {
          width: 100%;
        }
      }
    </style>

    <!-- <a href="Stylesheet.css"></a> -->
  </head>
  <body>
    <header><h1>ClonePlay</h1></header>
    <h2>Clone YouTube Playlist</h2>

    <div class="middle-box">
      <div class="Support">
        <h4>Supported apps</h4>
        <img src="Icons/app.png" alt="img2" class="icon" />
        <img src="Icons/music.png" alt="img2" class="icon" />
        <img src="Icons/youtube.png" alt="img2" class="icon" />
        <img src="Icons/spotify.png" alt="img2" class="icon" />
      </div>

      <form id="cloneForm">
        <label>Source Playlist ID:</label><br />
        <input
          type="text"
          id="sourceId"
          placeholder="PLxAJU9ros09AL2qQVEdh7s4gfYvz8S9TM"
        /><br /><br />

        <label>New Playlist Name:</label><br />
        <input
          type="text"
          id="newName"
          placeholder="Cloned Playlist"
        /><br /><br />

        <button type="submit" class="submitBtn">Clone</button>
      </form>
    </div>
    <button id="loginBtn" class="submitBtn">Login with Google</button>
    <div class="steps">
      <h3>Login needed for everytime you clone</h3>
    </div>

    <p id="result"></p>

    <footer>akdjfhjhkafhdk</footer>

    <script>
      function extractPlaylistId(str) {
        const m = str.match(/[?&]list=([a-zA-Z0-9_-]+)/);
        return (m ? m[1] : str).trim(); // returns clean ID
      }

      // Login button logic
      document.getElementById("loginBtn").addEventListener("click", () => {
        window.location.href = "/login";
      });

      // Clone form logic
      document
        .getElementById("cloneForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          // const sourceIdRaw = document.getElementById("sourceId").value;
          const sourceId = extractPlaylistId(
            document.getElementById("sourceId").value
          );

          const newName = document.getElementById("newName").value;

          const res = await fetch("/clone", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              sourcePlaylistId: sourceId,
              newTitle: newName,
            }),
          });

          const data = await res.json();

          const resultBox = document.getElementById("result");
          resultBox.style.display = "block";
          resultBox.innerText = res.ok
            ? "Playlist cloned successfully!"
            : "Couldn't clone. " + text;
        });
    </script>
  </body>
</html>
